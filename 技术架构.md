# Free_AI_Docker 技术架构设计

## 1. 整体架构
- 前端：Vue 3 + TypeScript
- 后端：Node.js + Express
- 数据库：PostgreSQL
- 消息队列：Redis (用于任务队列管理)
- 容器化：Docker

## 2. 前端架构
### 2.1 核心技术栈
- Vue 3 (组合式 API)
- TypeScript
- Vite (构建工具)
- Pinia (状态管理)
- Vue Router
- Axios (HTTP 客户端)
- Element Plus (UI 组件库)

### 2.2 主要功能模块
- 配置管理模块（API KEY、API URL、文件路径设置）
- 对话界面模块（AI 对话、消息展示）
- 文件管理模块（生成文件预览、下载）
- 任务执行状态展示模块
- WebSocket 实时通信模块

## 3. 后端架构
### 3.1 核心技术栈
- Node.js
- Express.js
- TypeScript
- Prisma (ORM)
- Socket.io (WebSocket)
- Bull (任务队列)

### 3.2 主要功能模块
- API 网关层
  - 请求验证
  - 路由分发
  - 错误处理
  
- 业务逻辑层
  - AI 服务模块（与 OpenAI 等模型交互）
  - 命令执行模块（安全沙箱环境）
  - 代码解析模块（识别代码、命令等）
  - 文件操作模块
  - 任务管理模块

- 数据访问层
  - 数据库操作
  - 缓存处理
  
### 3.3 中间件
- 日志中间件 (Winston)
- 身份认证中间件
- 请求限流中间件
- 错误处理中间件

## 4. 数据库设计
### 4.1 PostgreSQL 主要表结构
- users (用户表)
- conversations (对话历史表)
- tasks (任务执行记录表)
- files (生成文件记录表)
- configurations (用户配置表)

### 4.2 Redis 使用
- 任务队列
- 会话缓存
- 临时数据存储

## 5. 安全架构
- API 密钥加密存储
- 请求签名验证
- SQL 注入防护
- XSS 防护
- CSRF 防护
- 命令执行沙箱环境

## 6. 部署架构
### 6.1 Docker 容器化
- 前端容器
- 后端容器
- 数据库容器
- Redis 容器

### 6.2 Docker Compose 编排
- 服务依赖管理
- 环境变量配置
- 网络配置
- 数据卷挂载

## 7. 监控和日志
- 应用性能监控
- 错误日志收集
- 用户行为分析
- 系统资源监控

## 8. CI/CD
- 自动化测试
- 自动化构建
- 自动化部署
- 版本控制 (Git)

